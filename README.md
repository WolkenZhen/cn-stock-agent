
A 股短线自动选股与策略优化系统

项目介绍
本项目是一款专注于 A 股短线交易的智能化工具，核心实现 自动筛选 5 只高潜力短线股 + 月级策略参数自动优化，无需手动调整参数，每天运行即可持续迭代最优策略。兼顾流动性、收益性与风险控制，采用 180 天回溯周期（6 个月）平衡准确度与运行效率，适用于追求短线稳健收益的投资者，全程运行仅需 15-20 分钟。
核心功能
精准选股：从沪深 A 股中筛选 5 只短线潜力股（市值≥500 亿、日均成交额≥2 亿，排除 ST / 退市股，评分≥30 分）；
多因子增强评分：基于股价强势度、资金关注度、趋势完整性、RSI 动量、换手率稳定性 5 大因子加权评分，提升选股区分度；
策略自动优化：遍历 60 组参数组合（短期均线、长期均线等 5 类参数），通过 180 天历史数据回测，每日迭代最优参数；
真实回测验证：模拟实盘交易（含 0.15% 交易成本），加入止损逻辑（跌破支撑位 1.5% 止损），计算年化收益率、胜率、最大回撤；
资金智能管理：自动分配资金（70% 仓位，单只股票≤14%），输出购买数量、持仓成本、止损价、目标价（预期收益 2%）；
日志追溯复盘：自动保存选股结果、参数优化记录、交易信号，支持月度复盘与策略迭代；
全流程风险控制：过滤低流动性股票，交易区间限制在涨跌停内，设置止损 / 止盈规则，避免满仓操作。
代码逻辑解析
1. 核心文件结构
文件名称	核心作用
auto_strategy_optimizer.py	主程序：串联选股、参数优化、信号生成全流程，日常运行入口，输出 5 只潜力股 + 交易信号
config.py	基础配置：存储策略初始参数、市场信息，供main.py单只股票分析使用
trading_signal.py	信号生成：获取股票数据、计算均线 / 支撑阻力 / 涨跌停，输出买入 / 持有 / 卖出 / 观望信号
executor.py	建议输出：格式化核心交易建议（股票代码、买卖区间、关键价位）
explainer.py	报告生成：生成策略分析报告，说明信号逻辑、风险控制规则与迭代方向
main.py	单股分析入口：基于config.py配置，单独分析某只股票（如美的集团）
requirements.txt	依赖清单：明确项目所需 Python 包及版本，确保环境兼容
strategy_log/	日志目录：自动保存选股日志、参数优化日志、交易信号日志，支持回溯复盘

2. 核心流程逻辑
每日运行主程序

筛选可交易股票池（≤200只，高流动性）

多因子评分选出TOP5潜力股（评分≥30分）

遍历60组参数组合，回测180天历史数据

计算综合评分（收益×0.6+胜率×0.3-回撤×0.1）

确定当日最优参数

生成5只股票交易信号（含购买数量+止损/目标价）

保存选股/参数/信号日志

月度累计30天数据，输出最优策略



![alt text](image.png)






3. 关键模块详解
（1）自动选股模块（auto_strategy_optimizer.py）
筛选逻辑：市值≥500 亿（稳定性）、日均成交额≥2 亿（高流动性）、排除 ST / 退市股（风险控制）；
评分因子：近 5 日涨幅（30% 权重）、成交量放大率（20%）、均线多头排列（20%）、RSI（14 日，15%）、换手率稳定性（15%）；
输出：5 只高分股票（≥30 分，不足时用 20 分以上补充），自动保存至strategy_log/stock_selection_log.csv。
（2）参数优化模块（auto_strategy_optimizer.py）
优化参数：短期均线（4/5/6 天）、长期均线（18/20/22 天）、支撑阻力周期（4/5/6 天）、买入容忍度（0.008/0.01/0.012）、卖出容忍度（0.008/0.01/0.012），共 60 组组合；
回测逻辑：金叉买入（短期均线上穿长期均线 + 价格靠近支撑位）、死叉 + 止损卖出（跌破支撑位 1.5%），扣除交易成本；
最优参数选择：通过 3 只股票交叉验证（至少 2 次交易有效），综合评分最高的组合，保存至strategy_log/param_optimization_log.csv。
（3）信号生成模块（auto_strategy_optimizer.py）
数据来源：AKShare（东方财富数据，国内稳定无权限限制），主接口失败自动填充优质预设股票；
指标计算：均线（滚动平均）、支撑 / 阻力位（近 N 日高低点）、涨跌停（前一交易日收盘价 ±10%）；
信号类型：买入 / 卖出 / 持有 / 观望，输出购买数量（按资金均分）、止损价（支撑位 ×0.985）、目标价（阻力位 ×1.02）；
资金管理：70% 资金用于投资（30% 风险准备金），单只股票仓位≤14%，自动汇总资金使用情况。
安装与运行指南（全程虚拟环境隔离）
1. 环境准备
系统要求：macOS/Linux（Windows 需调整虚拟环境激活命令）；
Python 版本：3.8-3.10（兼容所有依赖包）；
网络要求：国内 IP（无需科学上网，AKShare 需访问东方财富数据）；
依赖包：akshare≥1.17.0、pandas==2.1.4、numpy、tqdm 等（详见 requirements.txt）。
2. 详细步骤（复制命令执行）
（1）创建项目目录并进入
bash
运行
# 示例：创建目录并进入（可自定义路径）
mkdir -p ~/cn-stock-ai-agent && cd ~/cn-stock-ai-agent
（2）创建并激活虚拟环境（隔离全局 Python）
bash
运行
# 创建虚拟环境（名称为venv）
python3 -m venv venv

# 激活虚拟环境（macOS/Linux）
source venv/bin/activate

# 激活成功验证：终端提示符前显示(venv)
（3）安装依赖包（确保版本兼容）
bash
运行
# 复制项目的requirements.txt到当前目录后执行
pip install --upgrade pip
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
（4）运行核心程序（自动选股 + 参数优化）
bash
运行
# 每日运行一次，自动生成5只潜力股+最优策略+交易信号
python auto_strategy_optimizer.py
（5）可选：单只股票分析（如美的集团）
bash
运行
# 基于config.py配置，单独分析某只股票的详细报告
python main.py
3. 运行结果说明
日志输出：程序运行后自动创建strategy_log文件夹，包含 3 类日志文件（选股日志、参数优化日志、交易信号日志）；
终端输出：依次显示筛选股票池（≤200 只）、TOP5 潜力股（含评分）、最优参数（含年化收益率 / 胜率 / 回撤）、交易信号（含购买数量 / 止损 / 目标价）、资金汇总；
月度优化：累计运行 30 天后，终端提示 “月度优化完成”，可通过日志筛选 30 天内综合评分最高的参数组合作为最终最优策略。
策略优化亮点（优于其他选股程序）
1. 精准平衡 “准确度 - 效率”
其他程序：多为固定参数（如 5/20 日均线）或长周期回溯（1 年 +），运行时间超 1 小时；
本项目：60 组参数组合（兼顾优化精度与速度）、180 天回溯周期（捕捉中期趋势），15-20 分钟完成运行，每日可轻松执行。
2. 多因子 + 风险控制双保障
其他程序：常依赖单一指标（如仅看均线交叉），缺乏止损机制；
本项目：5 大因子加权评分（避免单一指标陷阱），加入止损（跌破支撑位 1.5%）、止盈（2% 预期收益）、仓位控制（≤70%），风险更可控。
3. 资金管理智能化
其他程序：仅输出买卖信号，无资金分配建议；
本项目：自动分配资金（单只股票≤14% 仓位），输出购买数量、持仓成本、剩余资金，新手也能直接参考执行。
4. 日志追溯 + 复盘闭环
自动保存每日选股、参数、信号记录，支持追溯历史表现；
月度可通过日志分析 “哪些参数在近期市场更有效”，进一步细化优化范围，形成 “迭代 - 验证 - 优化” 的闭环。
5. 国内数据源稳定，无权限限制
采用 AKShare（东方财富数据），无需实名认证、无需 API Token，国内网络直接访问；
异常时自动填充优质预设股票（美的集团、招商银行等），避免因数据问题中断运行。
注意事项
风险提示：本工具仅提供策略分析与建议，不构成投资决策。股市有风险，实盘需结合基本面、大盘环境，建议先用小资金测试；
运行时间：每次运行约 15-20 分钟（取决于网络速度和 CPU 性能），可放在后台执行；
依赖兼容：严格按照requirements.txt安装依赖，避免版本冲突（尤其是 akshare≥1.17.0）；
网络问题：运行时关闭 VPN / 代理，确保国内 IP 访问，避免数据获取失败；
资金管理：默认初始资金 100000 元，可在generate_trading_signals函数中修改initial_cash自定义资金规模，仓位默认≤70%，不建议调整为满仓。
免责声明
本项目仅用于技术学习与策略研究，所有数据均来自公开数据源（东方财富），不构成任何投资建议、交易要约或要约邀请。投资者据此操作，风险自担。作者不对任何因使用本项目导致的投资损失承担责任。